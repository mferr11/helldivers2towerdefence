name: Java Format

on: [push, pull_request] # Will trigger whenever a push is made to the branch, regardless of which branch

jobs:
  format_check_java:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Set up OpenJDK21
        uses: actions/setup-java@v1
        with:
          java-version: '21'

      - name: Run Format Checker
        run: |
          cd $GRADLE_DIR
          chmod +x ./gradlew
          OUTPUT=$(./gradlew formatCheck || true)

          if echo "$OUTPUT" | grep -q "failed"; then
            echo "::warning title=Formatting Issue::Code formatting needs fixing"
          fi

          echo "$OUTPUT"

        env:
          GRADLE_DIR: 'source'
        continue-on-error: true # change this to false if you want the pipeline to fail when the format check fails
